\chapter{Digitalizace obrazovıch signálù}

Pøi digitálním zpracování obrazu je dosti èasto cílem zpracovávat obrazy, které vznikají jako obrazy spojité. Spojitá reprezentace mùe bıt ádána také pro vıstupy zpracování. Napøíklad tehdy, jestlie má bıt vısledek pozorován èlovìkem. Pro samotné digitální zpracování obrazu v poèítaèi není však spojitá reprezentace vhodná. Vhodnìjší je reprezentace diskrétní, kdy je obraz reprezentován spoèetnou (v praxi koneènou) mnoinou nìjakıch hodnot. Z uvedeného dùvodu provádíme pøed digitálním zpracováním pøevod obrazu do diskrétní podoby. Øíkáme, e obraz vzorkujeme. Dále se pøi praktické reprezentaci obrazù v poèítaèi vzorky nìkdy uchovávají jako celoèíselné hodnoty. V takovıch pøípadech pak skuteèné úrovnì signálu na tyto celoèíselné hodnoty pøevádíme, co nazıváme kvantováním. Po zpracování v digitalizované podobì mùe bıt naopak poadována rekonstrukce obrazu do podoby spojité. Problematice vzorkování, kvantování a rekonstrukce je vìnována tato kapitola.

\section{Vzorkování deterministicky popsanıch\\ obrazù} \label{sec:vzorkovani_deterministicky_popsanych_signalu}

Pøedpokládejme, e vzorkujeme vstupní obraz deterministicky popsanı spojitou obrazovou funkcí $f_{\mathrm{I}}(x, y)$. Aby vztahy, ke kterım dospìjeme, vyšly jednoduché, pøedpokládáme, e je obraz definován nad nekoneènou oblastí. Vısledek \emph{vzorkování \index{vzorkování}} obrazu je popsán funkcí $f_{\mathrm{S}}(x, y)$. Jako matematickı model vzorkování volíme souèin vstupního obrazu se vzorkovací funkcí $s(x, y)$. Je tedy

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_1.pdf}
    \end{center}
    \caption{\dvojt Vzorkovací funkce ve tvaru nekoneèného pole Diracovıch impulzù}
    \label{img:4_1}
\end{figure}

\begin{equation} \label{eq:4_1}
    f_\mathrm{S}(x, y) = f_\mathrm{I}(x, y) s(x, y)\,.
\end{equation}
Jako \emph{vzorkovací funkci \index{funkce!vzorkovací}} nejprve zvolíme nekoneèné pole Diracovıch impulzù navzájem vzdálenıch o $\Delta x$, $\Delta y$ (obr. \ref{img:4_1}). Tato funkce je popsána pøedpisem

\begin{equation} \label{eq:4_2}
    s(x, y) = \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} \delta(x - k\Delta x, y - l\Delta y)\,.
\end{equation}
Dosazením vztahu \eqref{eq:4_2} do vztahu \eqref{eq:4_1} obdríme pro $f_{\mathrm{S}}(x, y)$ následující pøedpis

\begin{equation} \label{eq:4_3}
    f_\mathrm{S}(x, y) = \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} f_\mathrm{I}(x, y) \delta(x -k\Delta x, y - l\Delta y)\,.
\end{equation}

Je zøejmé, e ke stanovení funkce $f_\mathrm{S}$ podle pøedpisu \eqref{eq:4_3} staèí znát funkèní hodnoty $f_\mathrm{I}$ pouze v bodech ($k\Delta x$, $l\Delta y$). Pøi praktické realizaci vzorkování jsou proto právì hodnoty $f_\mathrm{I}(k\Delta x, l\Delta y)$ uchovávány. Urèeme nyní Fourierovu transformaci $F_\mathrm{S}(u, v) = \mathscr{F}\{f_\mathrm{S}(x, y)\}$ vzorkovaného obrazu $f_\mathrm{S}(x, y)$. Nech $F_\mathrm{I}(u, v) = \mathscr{F}\{f_\mathrm{I}(x, y)\}$, $S(u, v) = \mathscr{F}\{s(x, y)\}$ jsou Fourierovy transformace funkcí $f_\mathrm{I}(x, y)$ a $s(x, y)$. Uplatní\-me-li na obì strany rovnice \eqref{eq:4_1} Fourierovu transformaci a vezmeme-li v úvahu vlastnost \eqref{eq:2_28b}, pak získáme

\begin{equation} \label{eq:4_4}
    F_\mathrm{S}(u, v) = F_\mathrm{I}(u, v) \ast S(u, v)\,.
\end{equation}
Fourierùv obraz nekoneèného pole Diracovıch impulzù jsme vypoèetli ji døíve v pøíkladì \ref{example:2_4}. Vyšlo

\begin{equation} \label{eq:4_5}
    S(u, v) = \frac{1}{\Delta x \Delta y} \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} \delta \left( u - \frac{k}{\Delta x}, v - \frac{l}{\Delta y} \right).
\end{equation}
Zaveïme frekvence $u_\mathrm{S}$, $v_\mathrm{S}$ vzorkování jako pøevrácené hodnoty vzdálenosti vzorkù

\begin{equation} \label{eq:4_6}
    u_\mathrm{S} = 1 / \Delta x, \quad v_\mathrm{S} = 1 / \Delta y\,.
\end{equation}
Dosazením vztahù \eqref{eq:4_5} a \eqref{eq:4_6} do vztahu \eqref{eq:4_4} a rozepsáním konvoluce máme

\begin{equation} \label{eq:4_7}
    F_\mathrm{S}(u, v) = u_\mathrm{S} v_\mathrm{S} \int\limits_{-\infty}^{\infty} \int\limits_{-\infty}^{\infty} F_\mathrm{I}(a, b) \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} \delta(u - a - k u_\mathrm{S}, v - b - l v_\mathrm{S}) \,\da\,\db\,.
\end{equation}
Vzájemnou zámìnou poøadí integrování a sumace a po úpravì obdríme

\begin{equation} \label{eq:4_8}
    F_\mathrm{S}(u, v) = u_\mathrm{S} v_\mathrm{S} \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} F_\mathrm{I} (u - k u_\mathrm{S}, v - l v_\mathrm{S})\,.
\end{equation}
Nyní jsme došli k vıznamnému závìru: Vıraz \eqref{eq:4_8} øíká, e frekvenèní spektrum $F_\mathrm{S}$ vzorkovaného obrazu se skládá ze sloek, kterımi je spektrum $F_\mathrm{I}$ obrazu pùvodního. Sloky se periodicky opakují ve vzdálenostech $u_\mathrm{S}$, $v_\mathrm{S}$ (obr. \ref{img:4_2}) a sèítají. Jak uvidíme pozdìji, bude mít pro úspìšnou rekonstrukci obrazu zásadní vıznam poadavek, aby se jednotlivé sloky spektra navzájem nepøekrıvaly. Zkoumejme tuto situaci blíe. Pøedpokládejme, e spektrum vstupního obrazu je omezené - tj., e platí

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_2.pdf}
    \end{center}
    \caption{\dvojt Spektrum pùvodního a vzorkovaného obrazu}
    \label{img:4_2}
\end{figure}

\begin{equation} \label{eq:4_9}
    F_\mathrm{I}(u, v) = 0, \,\, \mathrm{jestli\check{z}e} \,\, |u| > u_\mathrm{I} \cup |v| > v_\mathrm{I}\,,
\end{equation}
kde hodnoty $u_\mathrm{I}$, $v_\mathrm{I}$ jsou mezní frekvence vstupního obrazu. Z vırazu \eqref{eq:4_8} vyplıvá (viz. té obr. \ref{img:4_2}), e k pøekrıvání sloek spektra nedojde za podmínky, e platí nerovnosti

\begin{equation} \label{eq:4_10}
    u_\mathrm{S} \geq 2 u_\mathrm{I}, \quad v_\mathrm{S} \geq 2 v_\mathrm{I}\,.
\end{equation}
Nyní se budeme zabıvat otázkou, za jakıch podmínek lze ze \emph{vzorkovaného obrazu \index{obraz!vzorkovanı}} $f_\mathrm{S}(x, y)$ vytvoøit \emph{rekonstruovanı obraz \index{obraz!rekonstruovanı}} $f_\mathrm{R}(x, y)$ tak, aby byl shodnı se vstupním obrazem $f_\mathrm{I}(x, y)$. Pøedpokládáme, e rekonstrukci obrazu bude moné provést pomocí nìjakého filtru, kterı proto budeme nazıvat \emph{filtrem rekonstrukèním \index{filtr!rekonstrukèní}}. Oèekáváme, e rekonstrukèní filtr bude lineární a invariantní vùèi posunu. Filtr charakterizujeme odezvou $r(x, y)$ na Diracùv impulz (impulzová charakteristika filtru) a Fourierovou transformací $R(u, v)$ této odezvy (frekvenèní charakteristika). Tyto funkce však zatím neznáme a chceme je urèit.

Z odstavce \ref{sec:lin_sum_bod_zdroju} víme, e obraz na vıstupu rekonstrukèního filtru lze stanovit pomocí konvoluce vzorkovaného obrazu a odezvy filtru na Diracùv impulz. Je tedy

\begin{equation} \label{eq:4_11}
    f_\mathrm{R}(x, y) = f_\mathrm{S}(x, y) \ast r(x, y)\,.
\end{equation}
Ve frekvenèní doménì pak s ohledem na vlastnost \eqref{eq:2_28a} Fourierovy transformace máme

\begin{equation} \label{eq:4_12}
    F_\mathrm{R}(u, v) = F_\mathrm{S}(u, v) R(u, v)\,.
\end{equation}
Dosadíme-li do vztahu \eqref{eq:4_12} ze vztahu \eqref{eq:4_8}, dostaneme

\begin{equation} \label{eq:4_13}
    F_\mathrm{R}(u, v) = u_\mathrm{S} v_\mathrm{S} R(u, v) \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} F_\mathrm{I} (u - ku_\mathrm{S}, v - lv_\mathrm{S})\,.
\end{equation}
Pøedpokládejme, e nedojde k pøekrıvání jednotlivıch sloek spektra, jak jsme ji døíve diskutovali (vztahy \eqref{eq:4_10}). Ze vztahu \eqref{eq:4_13} pak vyplıvá, e jestlie navrhneme rekonstrukèní filtr tak, aby odfiltroval ty sloky spektra, pro které $k \neq 0$, $l \neq 0$, a sloku $k = 0$, $l = 0$ naopak propustil, pak $F_\mathrm{R}(u, v) = F_\mathrm{I}(u, v)$ a tedy i $f_\mathrm{R}(x, y) = f_\mathrm{I}(x, y)$, jak jsme pro rekonstrukci poadovali. Docházíme tedy k závìru, e k optimální rekonstrukci by frekvenèní charakteristika rekonstrukèního filtru mohla bıt napø. (obr. \ref{img:4_3})

\begin{equation} \label{eq:4_14} 
    R(u, v) = \left\{
    \begin{array}{cc}
    1, & {\left(|u|\le u_\mathrm{R} \right)\cap \left(|v|\le v_\mathrm{R} \right)} \\
    0, & \mathrm{jinak}
    \end{array}
    \right.,
\end{equation} 
kde $u_\mathrm{I} \leq u_\mathrm{R} \leq u_\mathrm{S}/2$, $v_\mathrm{I} \leq v_\mathrm{R} \leq v_\mathrm{S}/2$. (Pøesnì vzato dává filtr \eqref{eq:4_14} hodnotu $F_\mathrm{R}(u, v) = u_\mathrm{S} v_\mathrm{S} F_\mathrm{I}(u, v)$, co však nezmenšuje kvalitu rekonstrukce, protoe $u_\mathrm{S} v_\mathrm{S}$ je známá konstanta.) Zdùraznìme ještì jednou skuteènost, e podmínkou úspìšné rekonstrukce obrazu je splnìní poadavku, aby se jednotlivé sloky spektra $F_\mathrm{S}(u, v)$ vzorkovaného obrazu navzájem nepøekrıvaly. Jestlie mezní frekvence $u_\mathrm{I}$, $v_\mathrm{I}$ vstupního obrazu povaujeme za nemìnné, pak lze splnìní této podmínky zajistit vhodnou volbou frekvence vzorkování $u_\mathrm{S}$, $v_\mathrm{S}$ tak, aby byly splnìny nerovnosti \eqref{eq:4_10}. Uvedené nerovnosti jsou dvojrozmìrnou variantou známého Nyquistova vzorkovacího teorému, kterı øíká, e k tomu, aby mohl bıt signál úspìšnì rekonstruován, je nutné, aby vzorkovací frekvence byla alespoò dvojnásobkem nejvyšší frekvence, která je v signálu obsaena.

Pøi provádìní rekonstrukce obrazu mùe bıt vıhodné vyhnout se Fourierovì transformaci, která mùe bıt èasovì sloitá. Vztah \eqref{eq:4_11} napovídá, jak to udìlat. Dosadíme-li do vztahu \eqref{eq:4_11} vztah \eqref{eq:4_3}, pak po provedení konvoluce a úpravì obdríme pøedpis

\begin{equation} \label{eq:4_15}
    f_\mathrm{R}(x, y) = \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} f_\mathrm{I} (k\Delta x, l\Delta y) r(x - k\Delta x, y - l\Delta y)\,.
\end{equation}

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_3.pdf}
    \end{center}
    \caption{\dvojt Frekvenèní charakteristika obdélníkového rekonstrukèního filtru}
    \label{img:4_3}
\end{figure}

Abychom mohli vztahu \eqref{eq:4_15} prakticky vyuít, zbıvá ještì urèit impulzovou charakteristiku $r(x, y)$ rekonstrukèního filtru \eqref{eq:4_14}. Zpìtnou Fourierovou transformací získáme ze vztahu \eqref{eq:4_14} pøedpis

\begin{equation} \label{eq:4_16}
    r(x, y) = 4 u_\mathrm{R} v_\mathrm{R} \, \mathrm{sinc} (2 x u_\mathrm{R}) \, \mathrm{sinc} (2 y v_\mathrm{R})\,.
\end{equation}
Vidíme tedy, e v prostorové doménì lze rekonstrukci obrazu provést podle pøedpisu \eqref{eq:4_15} jako konvoluci vzorkù $f_\mathrm{I}(k\Delta x, l\Delta y)$ vstupního obrazu s funkcí sinc.

\section{Zpøesnìné modely vzorkování}

Zjednodušující pøedpoklady, které jsme zavedli v podkapitole \ref{sec:vzorkovani_deterministicky_popsanych_signalu}, smìøovaly k tomu, abychom získali jednoduché a názorné vısledky. Pøestoe jsou takto získané vısledky uiteèné, povaujeme za nutné alespoò naznaèit moné modifikace uvedeného postupu, jejich cílem je vìrnìjší popis skuteènosti.
\newline
\newline
\noindent \textit{Koneènı obraz a koneènı poèet vzorkù:} V pøedchozí podkapitole jsme pøedpokládali, e obraz, kterı vzorkujeme, je definován nad nekoneènou oblastí a e vzorkováním získáme nekoneèné mnoství vzorkù. V praxi však pracujeme s obrazy, které jsou koneèné a koneènı musí bıt také poèet vzorkù. Zlepšení souhlasu teoretického modelu vzorkování se skuteèností by v tomto ohledu bylo moné dosáhnout zavedením vzorkovací funkce ve tvaru koneèného pole Diracovıch impulzù

\begin{equation} \label{eq:4_17}
    s(x, y) = \sum\limits_{k=-K}^{K} \sum\limits_{l=-L}^{L} \delta(x - k\Delta x, y - l\Delta y)\,,
\end{equation}
kde \textit{K},\textit{L} jsou meze pole. Tento postup však bohuel komplikuje další analızu.
\newline
\newline
\noindent \textit{Obecnı tvar vzorkovacího pulzu:} A doposud jsme pøedpokládali, e matematickım modelem získání vzorkù je souèin obrazu s vzorkovací funkcí. Jako vzorkovací funkci jsme pouívali funkci sloenou z Diracovıch impulzù. Obecnì však mohou mít vzorkovací pulzy i jinı tvar. Jestlie je tvar pulzu popsán funkcí $p(x, y)$, pak mùeme vzorkovací funkci popsat vztahem

\begin{equation} \label{eq:4_18}
    s(x, y) = \sum\limits_{k=-K}^{K} \sum\limits_{l=-L}^{L} p(x - k\Delta x, y - l\Delta y)\,.
\end{equation}

\noindent \textit{Vzorkování integrací:} Senzory, které lze prakticky realizovat, nedokáí sejmout hodnotu v nekoneènì malém bodì. Místo toho je sejmuta jakási prùmìrná hodnota podél citlivé plošky senzoru. Tuto skuteènost lze zohlednit tak, e jako matematickı model získávání vzorkù volíme integraci

\begin{equation} \label{eq:4_19}
    f_\mathrm{S}(k\Delta x, l\Delta y) = \int\limits_{k\Delta x - \alpha}^{k\Delta x + \alpha} \int\limits_{l\Delta y - \beta}^{l\Delta y + \beta} f_\mathrm{I}(x, y) p( x - k\Delta x, y - l\Delta y)\,\dx\,\dy\,,
\end{equation}
kde $\alpha$, $\beta$ jsou poloviny délek stran snímací plošky senzoru, kterou si zde pøedstavujeme jako obdélník. Rozmìry snímací plošky pøi tom pøedpokládáme menší, ne je teoretická vzdálenost vzorkovacích bodù. Funkce $p(x, y)$ popisuje prùbìh citlivosti plošky. Vzorkování integrací má znaènı vıznam. To proto, e a chceme èi nechceme, vdy k nìmu v praxi do urèité míry dochází. Ukame proto další monou interpretaci vztahu \eqref{eq:4_19}. Zámìnou promìnnıch pøevedeme vıraz \eqref{eq:4_19} na tvar

\begin{equation} \label{eq:4_20}
    f_\mathrm{S}(k\Delta x, l\Delta y) = \int\limits_{- \alpha}^{\alpha} \int\limits_{- \beta}^{\beta} f_\mathrm{I}(k\Delta x - a, l\Delta y - b)p(-a, -b)\,\da\,\db\,.
\end{equation}

Vztah \eqref{eq:4_20} je vıpoètem konvoluce funkcí $f_\mathrm{I}(x, y)$, $p(-x, -y)$. Vısledek konvoluce pouijeme jen v bodech $k\Delta x$, $l\Delta y$ (mimo tyto body pøedpokládáme funkèní hodnotu $f_\mathrm{S}$ rovnu 0). Mùeme proto psát

\begin{equation} \label{eq:4_21}
    f_\mathrm{S}(x, y) = \left[ f_\mathrm{I}(x, y) \ast p(-x, -y) \right] \sum\limits_{k=-\infty}^{\infty} \sum\limits_{l=-\infty}^{\infty} \delta( x - k\Delta x, y - l\Delta y)\,.
\end{equation}

Vıraz \eqref{eq:4_21} ukazuje, e vzorkování integrací má stejnı úèinek, jako kdybychom provedli konvoluci vstupního obrazu $f_\mathrm{I}(x, y)$ se vzorkovací funkcí $p(-x, -y)$ a pak následnì provedli vzorkování polem Diracovıch impulzù. Jak vyplıvá z vlastnosti \ref{eq:2_28a} Fourierovy transformace, realizuje konvoluce obrazu se vzorkovací funkcí filtraci obrazu. Ta mùe bıt nìkdy neádoucí, protoe zpùsobuje degradaci obrazu. Jindy mùe bıt naopak vítaná - napø. tehdy, jestlie vzorkování obrazu probíhá na niší frekvenci, ne odpovídá Nyquistovu teorému, a je proto nutné potlaèit v obraze vyšší frekvenèní sloky.

\section{Aliasing} \label{sec:aliasing} \index{aliasing}

Ve vztahu \eqref{eq:4_8} jsme ukázali, e frekvenèní spektrum obrazu po vzorkování se skládá ze sloek, které jsou tvoøeny frekvenèním spektrem vstupního obrazu. Tyto sloky se periodicky opakují ve vzdálenostech $u_\mathrm{S}$, $v_\mathrm{S}$ a sèítají. Zjistili jsme také, e k tomu, aby mohl bıt obraz úspìšnì rekonstruován, je nutné, aby se jednotlivé sloky spektra navzájem nepøekrıvaly. Dosud jsme však neøešili otázku, co se stane v pøípadì, e tato podmínka není splnìna. Vìnujme se nyní tomuto problému podrobnìji. Na základì vztahu \eqref{eq:4_8} je moné spektrum obrazu po vzorkování zapsat ve tvaru

\begin{equation} \label{eq:4_22}
    F_\mathrm{S}(u, v) = u_\mathrm{S} v_\mathrm{S} \left[ F_\mathrm{I}(u, v) + F_\mathrm{Q}(u, v) \right]\,,
\end{equation}
kde $F_\mathrm{I}(u, v)$ je spektrum pùvodního obrazu a $F_\mathrm{Q}(u, v)$ zahrnuje všechny ty sloky spektra $F_\mathrm{S}(u, v)$ obrazu po vzorkování, pro které je ve vırazu \eqref{eq:4_8} $k \neq 0$, $l \neq 0$ (sloka $k = 0$, $l = 0$ je zastoupena èlenem $F_\mathrm{I}(u, v)$). Pøedpokládejme nyní, e se jednotlivé sloky spektra navzájem pøekrıvají (obr. \ref{img:4_4}) a e na takto vzorkovanı obraz aplikujeme rekonstrukèní filtr s~frekvenèní charakteristikou

\begin{equation} \label{eq:4_23} 
    R\left(u,v\right) = \left\{
    \begin{array}{cc}
    1, & \left(|u| \le u_\mathrm{S} /2\right) \cap \left(|v|\le v_\mathrm{S} /2\right) \\
    0, & \mathrm{jinak}
    \end{array}
    \right. .  
\end{equation}

Zvolenı rekonstrukèní filtr propouští kromì sloky $k = 0$, $l = 0$ (uiteèná sloka) frekvenèního spektra také urèité èásti sloek $k \neq 0$, $l \neq 0$ (neádoucí sloky). Na obr. \ref{img:4_4} jsou pøenášené èásti neádoucích sloek vyšrafovány. Naopak si však také mùeme povšimnout, e nejsou pøenášeny nìkteré èásti uiteèné sloky. Chyba zpùsobená neúplnım pøenesením uiteèné sloky zpùsobí rozmazání obrazu (potlaèení vyšších frekvencí). Naopak chyba zpùsobená pøenosem èástí neádoucích sloek dává v obraze vzniknout novım útvarùm. Tento jev nazıváme aliasing. Nech $f_\mathrm{ID}(x, y)$ je obraz degradovanı neúplnım pøenosem uiteèné sloky. Vznik aliasingu mùeme matematicky modelovat tak, e na obraz $f_\mathrm{ID}(x, y)$ superponujeme chybovı obraz $a(x, y)$ vzniklı èásteènım pøenosem neádoucích sloek. Je tedy

\begin{equation} \label{eq:4_24}
    f_\mathrm{R}(x, y) = f_\mathrm{ID}(x, y) + a(x, y)\,.
\end{equation}
Chybovı obraz $a(x, y)$ mùeme popsat vztahem

\begin{equation} \label{eq:4_25}
    a(x, y) = \mathscr{F}^{-1} \left\{ R(u, v) F_\mathrm{Q}(u, v) \right\}\,.
\end{equation}

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_4.pdf}
    \end{center}
    \caption{\dvojt Vznik aliasingu pøekrıváním sloek spektra vzorkovaného obrazu}
    \label{img:4_4}
\end{figure}

Pokusme se nyní kvantifikovat míru degradace rekonstruovaného obrazu, kterou aliasing zpùsobí. Ke kvantifikaci pouijeme stochastického pøístupu. Nech $\mathbf{f}_\mathrm{I}(x, y)$ je vstupní náhodné pole a $G_\mathrm{f_\mathrm{I}f_\mathrm{I}}(x, y)$ nech je jeho vıkonová spektrální hustota. Na míru degradace rekonstruovaného obrazu budeme usuzovat na základì energetické bilance. Energie $E_\mathrm{I}$ vstupního obrazového pole je

\begin{equation} \label{eq:4_26}
    E_\mathrm{I} = \int\limits_{-\infty}^{\infty} \int\limits_{-\infty}^{\infty} G_\mathrm{f_\mathrm{I}f_\mathrm{I}} (u, v)\,\du\,\dv\,.
\end{equation}

Z této energie je rekonstrukèním filtrem na vıstup pøenášeno mnoství $E_{\mathrm{IR}}$, kde

\begin{equation} \label{eq:4_27}
    E_\mathrm{IR} = \int\limits_{-u_\mathrm{S}/2}^{u_\mathrm{S}/2} \int\limits_{-v_\mathrm{S}/2}^{v_\mathrm{S}/2} G_\mathrm{f_\mathrm{I}f_\mathrm{I}} (u, v)\,\du\,\dv\,.
\end{equation}

Rekonstrukèním filtrem je na vıstup ovšem také èásteènì pøenášena energie neádoucích sloek. K urèení velikosti této energie bychom mìli vyšetøovat, jak do oblasti $\langle - u_\mathrm{S}/2, u_\mathrm{S}/2 \rangle\times \langle - v_\mathrm{S}/2, v_\mathrm{S}/2 \rangle$ kadá z tìchto sloek pøispívá. Není tìké zdùvodnit, e energie neádoucích sloek pøenášená v~oblasti $\langle - u_\mathrm{S}/2, u_\mathrm{S}/2 \rangle \times \langle - v_\mathrm{S}/2, v_\mathrm{S}/2 \rangle$ je stejná jako energie, kterou pøenáší uiteèná sloka mimo tuto oblast (prosíme ètenáøe, aby platnost tohoto tvrzení promyslel). Energie $E_\mathrm{A}$ neádoucích sloek pøenášená rekonstrukèním filtrem na vıstup tedy je

\begin{equation} \label{eq:4_28}
    E_\mathrm{A} = E_\mathrm{I} - E_\mathrm{IR}\,.
\end{equation}

Relativní chybu $\varepsilon_\mathrm{A}$ zpùsobenou aliasingem lze pak vyjádøit podílem

\begin{equation} \label{eq:4_29}
    \varepsilon_\mathrm{A} = E_\mathrm{A} / E_\mathrm{I}\,.
\end{equation}

K omezení jevù zpùsobenıch aliasingem mùeme pouít filtrace, kterou provedeme ještì pøed vzorkováním. Cílem filtrace je potlaèení vysokıch frekvencí v obraze, èím budou lépe zajištìny poadavky Nyquistova teorému. Obr. \ref{img:4_5} znázoròuje matematickı model takového postupu: Pøed vzorkování je zaøazen filtr s frekvenèní charakteristikou $H(u, v)$. Rekonstrukce je provedena rekonstrukèním filtrem dle vztahu \eqref{eq:4_23}. Zaøazením filtru $H(u, v)$ do øetìzce zpracování hrozí ovšem další degradace obrazu. Je tedy nutné zvolit takovı filtr, kde omezení jevù aliasingu pøevauje nad touto dodateènou degradací.

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_5.pdf}
    \end{center}
    \caption{\dvojt Matematickı model redukce aliasingu}
    \label{img:4_5}
\end{figure}

Nech $\mathbf{f}_\mathrm{H}(x, y)$ je náhodné pole vzniklé aplikací filtru $H(u, v)$ na vstupní náhodné obrazové pole $\mathbf{f}_\mathrm{I}(x, y)$ a pole $\mathbf{f}_\mathrm{S}(x, y)$ nech je pole vzniklé vzorkováním pole $\mathbf{f}_\mathrm{H}(x, y)$. Oznaème $E_\mathrm{H}$ celkovou energii pole $\mathbf{f}_\mathrm{H}$, a dále oznaème $E_\mathrm{HR}$ energii té èásti uiteèné sloky pole $\mathbf{f}_\mathrm{S}$, která je propuštìna filtrem $R(u, v)$ na vıstup. S vyuitím vztahu \eqref{eq:3_27} máme

\begin{eqnarray} \label{eq:4_30_31}
    E_\mathrm{H} &=& \int\limits_{-\infty}^{\infty} \int\limits_{-\infty}^{\infty} G_{\mathrm{f}_\mathrm{I} \mathrm{f}_\mathrm{I}} \left(u, v\right) \left| H(u, v) \right|^2 \,\du \,\dv, \\
    E_\mathrm{HR} &=& \int\limits_{-u_\mathrm{S}/2}^{u_\mathrm{S}/2} \int\limits_{-v_\mathrm{S}/2}^{v_\mathrm{S}/2} G_{\mathrm{f}_\mathrm{I} \mathrm{f}_\mathrm{I}} \left(u, v\right) \left| H(u, v) \right|^2 \,\du \,\dv\,.
\end{eqnarray}

Chybu $\varepsilon_\mathrm{A}$ zpùsobenou aliasingem a chybu $\varepsilon_{\mathrm{H}}$ zpùsobenou zaøazením filtru $H(u, v)$ lze vyjádøit vztahy

\begin{equation} \label{eq:4_32}
    \varepsilon_\mathrm{A} = (E_\mathrm{H} - E_\mathrm{HR}) / E_\mathrm{H}, \quad \varepsilon_\mathrm{H} = (E_\mathrm{IR} - E_\mathrm{HR}) / E_\mathrm{IR}\,.
\end{equation}

\section{Praktické metody rekonstrukce obrazu} \label{sec:prakticke_metody_rekonstrukce_obrazu}

Úkolem rekonstrukce je získat hodnoty jasu v~bodech leících mimo rastr, v~nìm jsou k~dispozici hodnoty vzorkù. Uvedenı problém vzniká napø. pøi vykreslování obrazu nebo pøi provádìní geometrickıch operací s~obrazy (kapitola \ref{sec:bodove_algebraicke_a_geometricke_operace_s_obrazy}). V podkapitole \ref{sec:vzorkovani_deterministicky_popsanych_signalu} jsme ukázali, e rekonstrukci obrazu po vzorkování lze v prostorové doménì provést konvolucí vzorkù obrazu s funkcí sinc (vztahy \eqref{eq:4_15}), \eqref{eq:4_16}). Protoe Fourierovım obrazem funkce sinc je ideální rekonstrukèní filtr dle vztahu \eqref{eq:4_14}, je tento postup za zvolenıch pøedpokladù optimální z hlediska pøesnosti rekonstrukce. Funkce sinc je však bohuel pro provádìní konvoluce ponìkud nepøíjemná. Její hodnoty jsou témìø všude nenulové, a proto do kadého bodu rekonstruovaného obrazu teoreticky pøispívají všechny vzorky. Tato skuteènost vede k vysoké èasové sloitosti rekonstrukce. Navíc je pøesné splnìní pøedpokladù, za nich byl ideální rekonstrukèní filtr odvozen, prakticky sotva moné. V praxi se proto èasto pouívají filtry, které sice nejsou ideálními rekonstrukèními filtry, ale zato umoòují rychlı vıpoèet konvoluce. Rychlosti je dosahováno tím, e je impulzová charakteristika filtru nenulová jen na malé oblasti, take do kadého bodu rekonstruovaného obrazu pøispívá pouze omezenı poèet vzorkù. Frekvenèní charakteristika takovıch filtrù se však zpravidla dosti odchyluje od charakteristiky rekonstrukèního filtru ideálního, co teoreticky vede k niší kvalitì rekonstrukce. Uveïme nìkolik pøíkladù impulzních a odpovídajících frekvenèních charakteristik èastìji pouívanıch rekonstrukèních filtrù:
\newline
\newline
\noindent 1) sinc:

\begin{equation} \label{eq:4_33a}
    r(x, y) = u_\mathrm{S} v_\mathrm{S} \sinc(u_\mathrm{S} x) \sinc (v_\mathrm{S} y)\,,
\end{equation}

\begin{equation} \label{eq:4_33b}
    R\left(u,v\right) = \left\{
    \begin{array}{cc}
    1, & \left(|u|\le u_\mathrm{S} /2\right) \cap \left(|v|\le v_\mathrm{S} /2\right) \\
    0, & \mathrm{jinak}
    \end{array}
    \right. ;
\end{equation}

\noindent 2) ètverec:

\begin{equation} \label{eq:4_34a}
    r_0 \left(x, y\right) = \left\{
    \begin{array}{cc}
    1, & \left(-\Delta x/2<x\le \Delta x/2\right) \cap \left(-\Delta y/2<y\le \Delta y/2\right) \\
    0, & \mathrm{jinak}
    \end{array}
    \right. ,
\end{equation}

\begin{equation} \label{eq:4_34b}
    R_0 \left(u, v\right) = \Delta x \Delta y\, \mathrm{sinc} \, (u \Delta x)\, \mathrm{sinc} \, (v \Delta y)\,;
\end{equation}

\noindent 3) trojúhelník:

\begin{equation} \label{eq:4_35ab}
    r_1 \left(x, y\right) = r_0(x, y) \ast r_0(x, y), \quad R_1(u, v) = R_0^2(u, v)\,;
\end{equation}

\noindent 4) zvon:

\begin{equation} \label{eq:4_36ab}
    r_2 \left(x, y\right) = r_0(x, y) \ast r_1(x, y), \quad R_2(u, v) = R_0^3(u, v)\,;
\end{equation}

\noindent 5) kubickı B-spline:

\begin{equation} \label{eq:4_37ab}
    r_3 \left(x, y\right) = r_0(x, y) \ast r_2(x, y), \quad R_3(u, v) = R_0^4(u, v)\,;
\end{equation}

\noindent 6) gaussián:

\begin{equation} \label{eq:4_38ab}
    r \left(x, y\right) = \frac{1}{2 \pi \sigma^2} \exp \left[ - \frac{x^2 + y^2}{2\sigma^2}\right], \quad R(u, v) = \exp \left[ - \frac{\sigma^2( u^2 + v^2)}{2}\right].
\end{equation}

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_6.pdf}
    \end{center}
    \caption{\dvojt Prùbìhy èastìji pouívanıch rekonstrukèních filtrù ($\Delta x = u_{\mathrm{S}} = 1$)}
    \label{img:4_6}
\end{figure}

Prùbìhy uvedenıch funkcí (v jednorozmìrné variantì) jsou uvedeny na obr. \ref{img:4_6}. Poznamenejme, e kvantifikaci vìrnosti rekonstrukce, které lze zvolenım filtrem dosáhnout, je moné provést podobnì jako v odstavci \ref{sec:aliasing} energetickou bilancí. K hodnocení mùe slouit mnoství energie, které zvolenı rekonstrukèní filtr pøenáší v pásmu, kde filtr ideální má frekvenèní charakteristiku rovnu nule, a také rozdíl v mnoství energií pøenášenıch zvolenım a ideálním filtrem v pásmu, kde filtr ideální má frekvenèní charakteristiku rovnu jedné.

V~praxi se rekonstrukce dosti èasto provádí interpolací. Nejèastìji se pouívá interpolace bilineární nebo bikubické. Øeknìme, e hodnota jasové funkce má bıt stanovena v~bodì o souøadnicích $x, y$ a e $\Delta x = \Delta y = 1$. Zaveïme souøadnice $\xi$, $\eta$ ($0 \leq \xi$, $\eta < 1$) pomocí vztahù

\begin{equation} \label{eq:4_39}
    \xi = x - \lfloor x \rfloor, \quad \eta = y - \lfloor y \rfloor\,.
\end{equation}
Dále pro struènost zápisu polome

\begin{equation} \label{eq:4_40}
    \mathbf{a} = (\lfloor x \rfloor, \lfloor y \rfloor), \quad \mathbf{b} = (\lfloor x \rfloor + 1, \lfloor y \rfloor)\,,
\end{equation}

\begin{equation}
    \mathbf{c} = (\lfloor x \rfloor, \lfloor y \rfloor + 1), \quad \mathbf{d} = (\lfloor x \rfloor + 1, \lfloor y \rfloor + 1)\,.\nonumber
\end{equation}

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_7.pdf}
    \end{center}
    \caption{\dvojt Bilineární interpolace jasu}
    \label{img:4_7}
\end{figure}

Nech symboly $a$, $b$, $c$, $d$ oznaèují body, které jsou reprezentovány vektory $\mathbf{a}$, $\mathbf{b}$, $\mathbf{c}$, $\mathbf{d}$. Bilineární interpolace je popsána následujícím vztahem (obr. \ref{img:4_7})

\begin{eqnarray} \label{eq:4_41}
    f(x, y) &=& f(\lfloor x \rfloor + \xi, \lfloor y \rfloor + \eta) \\
    &=& \left[ \left( 1 - \xi\right), \xi \right] \left[
    \begin{array}{cc}
    f(\mathbf{a}) & f(\mathbf{c}) \\
    f(\mathbf{b}) & f(\mathbf{d})
    \end{array}
    \right]
    \left[
    \begin{array}{c}
    (1 - \eta) \\
    \eta
    \end{array}
    \right] \nonumber \\
    &=& (1 - \xi)(1 - \eta)f(\mathbf{a}) + \xi(1 - \eta)f(\mathbf{b}) + (1 - \xi)\eta f(\mathbf{c}) + \xi \eta f(\mathbf{d})\,. \nonumber
\end{eqnarray}
 
Poznamenejme, e vztah \eqref{eq:4_41} dává pro hodnotu $f(x, y)$ tentı vısledek jako konvoluce s~filtrem $r_1(x, y)$ dle vztahu \eqref{eq:4_35ab}. Vztah \eqref{eq:4_41} má ovšem velmi názornou interpretaci a také v~programech jej lze velmi snadno realizovat.

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_8.pdf}
    \end{center}
    \caption{\dvojt Bikubická interpolace jasu}
    \label{img:4_8}
\end{figure}

Pøi vyšších nárocích na kvalitu interpolace lze poít interpolace bikubické (obr. \ref{img:4_8}). Vıpoèet lze provést pomocí vztahu

\begin{eqnarray} \label{eq:4_42}
    f( \lfloor x \rfloor + \xi, \lfloor y \rfloor + \eta) &=& \\
    \left[ g_1(\xi), g_2(\xi), g_3(\xi), g_4(\xi) \right] &&\left[
    \begin{array}{cccc}
    f(\mathbf{a}) & f(\mathbf{c}) & f_y(\mathbf{a}) & f_y(\mathbf{c}) \\
    f(\mathbf{b}) & f(\mathbf{d}) & f_y(\mathbf{b}) & f_y(\mathbf{d}) \\
    f_x(\mathbf{a}) & f_x(\mathbf{c}) & 0 & 0 \\
    f_x(\mathbf{b}) & f_x(\mathbf{d}) & 0 & 0
    \end{array}
    \right]
    \left[
    \begin{array}{c}
    g_1(\eta) \\
    g_2(\eta) \\
    g_3(\eta) \\
    g_4(\eta)
    \end{array}
    \right]. \nonumber
\end{eqnarray}
Funkce $g_1$, $g_2$, $g_3$, $g_4$ jsou definovány následujícími vztahy (obr. \ref{img:4_9})

\begin{eqnarray} \label{eq:4_43}
    g_1(\xi) &= 1 - 3 \xi^2 + 2\xi^3, \quad g_2(\xi) &= 3\xi^2 - 2\xi^3,\\
    g_3(\xi) &= \xi - 2 \xi^2 + \xi^3, \quad g_4(\xi) &= -\xi^2 + \xi^3. \nonumber
\end{eqnarray}

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_9.pdf}
    \end{center}
    \caption{\dvojt Funkce $g_1(\xi)$, $g_2(\xi)$, $g_3(\xi)$, $g_4(\xi)$}
    \label{img:4_9}
\end{figure}

Hodnoty $f_x$, $f_x$ jsou hodnoty derivací (podle $x$ resp. podle $y$) jasové funkce v~odpovídajícím bodì. Hodnoty derivací nahradíme diferencemi. Napø.

\begin{eqnarray} \label{eq:4_44}
    f_x(\mathbf{a}) &=& \frac{f(\lfloor x \rfloor + 1, \lfloor y \rfloor) - f(\lfloor x \rfloor - 1, \lfloor y \rfloor)}{2}\,,\\
    f_y(\mathbf{a}) &=& \frac{f(\lfloor x \rfloor, \lfloor y \rfloor + 1) - f(\lfloor x \rfloor, \lfloor y \rfloor - 1)}{2}\,. \nonumber
\end{eqnarray}

Na krajích obrazu, kde nejsou hodnoty poadované vztahem \eqref{eq:4_44} k dispozici, lze pouít nesymetrickıch diferenèních vzorcù.

\section{Kvantování obrazovıch signálù}

Pøi praktické reprezentaci signálù v poèítaèi je èasto potøebné uchovávat jednotlivé vzorky signálu v promìnnıch s~omezenım rozsahem (byte, slovo atd.). V takovıch pøípadech provádíme pøevod skuteènıch úrovní signálu na hodnoty, které lze v~promìnné zvoleného typu uchovávat, co nazıváme \emph{kvantováním \index{kvantování}}. Na konci øetìzce digitálního zpracování je naopak èasto potøebné obraz na základì jeho kvantované reprezentace opìt zrekonstruovat tak, aby co nejlépe odpovídal obrazu teoretickému. V tomto odstavci formulujeme uvedenou úlohu ponìkud podrobnìji a naznaèíme také její moné øešení.

\begin{figure}[th]
    \begin{center}
        \includegraphics[scale=1.0]{04_digitalizace/images/img_4_10.pdf}
    \end{center}
    \caption{\dvojt Kvantování jasu}
    \label{img:4_10}
\end{figure}

Zvolme v~obraze nìjakı libovolnı bod. Nech $f$ je hodnota jasu v~tomto bodì. Pøedpokládejme, e $f$ vdy nabıvá reálnıch hodnot $a_\mathrm{L} \leq f < a_\mathrm{H}$, kde $a_\mathrm{L}$, $a_\mathrm{H}$ znaèí známou dolní a horní mez jasu. Promìnné, které pouíváme k uchovávání vzorkù, nech umoòují uloení celıch èísel v rozsahu 0 a $I-1$. Pøechod od reálné hodnoty $f$ k~celoèíselné~hodnotì $i \in \{0, 1, \dots, I-1\}$ lze uskuteènit podle pøedpisu $i = q(f)$, kterı nazıváme kvantovaním. Problémem je nalézt optimální kvantovací funkci $q$. Kvantovací funkce bıvá obvykle zkonstruována následujícím postupem: Zvolme $I-1$ hodnot $d_i$, $i = 1, 2, \dots, I-1$, které interval $\langle a_\mathrm{L}, a_\mathrm{H})$ rozdìlí na $I$ podintervalù. Pøedpokládejme, e platí $d_i < d_{i+1}$ a zaveïme dále oznaèení $a_\mathrm{L} = d_0$, $a_\mathrm{H} = d_\mathrm{I}$. \emph{Kvantovací funkce \index{funkce!kvantovací}} $q$ zobrazuje všechny hodnoty jasu z~intervalu $\langle d_i, d_{i+1})$ na celé èíslo $i$. Problém nalezení kvantovací funkce se v~tomto pøípadì redukuje na nalezení $I-1$ hodnot $d_1, d_2, \dots, d_{I-1}$. Oznaème $f_\mathrm{R}$ hodnotu jasu po rekonstrukci. K rekonstrukci pouijeme funkce $f_\mathrm{R} = r(i)$. Rekonstrukèní funkce $r$ mùe bıt v~praxi snadno realizována tabulkou. Funkce $r$ zobrazuje celoèíselnou hodnotu $i$ na reálnou hodnotu $r_i$. V úloze o kvantování hledáme pro danı rozsah $I$ a pro jistou tøídu pøedpokládanıch obrazovıch signálù hodnoty $d_i$ a $r_i$ tak, aby rekonstruované hodnoty jasu v jistém smyslu co nejlépe odpovídaly jasu pùvodnímu (obr. \ref{img:4_10}).

K øešení úlohy, kterou jsme právì formulovali, mùeme pouít stochastického pøístupu. Povaujme vzorek jasu za náhodnou promìnnou s hustotou pravdìpodobnosti $p_\mathrm{f}(z)$ (obr. \ref{img:4_10}, pøipomeòme, e hodnota $p_\mathrm{f}(z)\,\dz$ udává pravdìpodobnost jevu, e jas padne do intervalu $(z, z+\dz\rangle$). Oznaème $\mathbf{f}$, $\mathbf{f}_\mathrm{R}$ náhodné promìnné popisující velikost pùvodního a rekonstruovaného jasu. Hodnoty $d_i$, $r_i$ nalezneme tak, aby byla minimalizována kvantizaèní chyba $\varepsilon = \mathrm{E}\{(\mathbf{f}_\mathrm{R} - \mathbf{f})^2\}$. Uvedenı vztah vychází z~pøedstavy, e pro jasy, které se v~obraze vyskytují málo, lze tolerovat vìtší diferenci $f_\mathrm{R} - f$ ne pro jasy, které se vyskytují èasto. Pouitím operace støední hodnoty je zajištìno, e se diference $f_\mathrm{R} - f$ na celkové chybì podílí úmìrnì hustotì pravdìpodobnosti jasu $p_\mathrm{f}$. Úpravami postupnì dostáváme

\begin{eqnarray} \label{eq:4_45}
    \varepsilon &=& \mathrm{E} \left\{ \left[ \mathbf{f}_\mathrm{R} - \mathbf{f} \right]^2 \right\} = \mathrm{E} \left\{ \left[ r(q(\mathbf{f} )) - \mathbf{f} \right]^2 \right\} \\
    &=& \int\limits_{a_L}^{a_H} \left[ r(q(z)) - z \right]^2 p_\mathrm{f}(z)\,\dz = \sum\limits_{i=0}^{I-1} \int\limits_{d_i}^{d_{i+1}} ( r_i - z)^2 p_\mathrm{f}(z)\,\dz\,. \nonumber
\end{eqnarray}

Jestlie je poèet $I$ úrovní dostateènì velkı, mùeme èasto hustotu pravdìpodobnosti $p_\mathrm{f}(z)$ uvnitø jednoho kvantovacího intervalu $\langle d_i, d_{i+1})$ povaovat za konstantní, a to $p_\mathrm{f}(r_i)$, protoe zajisté bude $d_i \leq r_i \leq d_{i+1}$. Ze vztahu \eqref{eq:4_45} pak dostáváme

\begin{eqnarray} \label{eq:4_46}
    \varepsilon &=& \sum\limits_{i=0}^{I-1} p_\mathrm{f}(r_i) \int\limits_{d_i}^{d_{i+1}} ( r_i - z)^2 \,\dz \\
    &=& \frac{1}{3} \sum\limits_{i=0}^{I-1} p_\mathrm{f}(r_i) \left[ (d_{i+1} - r_i )^3 - (d_i - r_i)^3 \right]. \nonumber
\end{eqnarray}

Z podmínky minima $\frac{\partial \varepsilon}{\partial r_i} = 0$ stanovíme

\begin{equation} \label{eq:4_47}
    r_i = \frac{d_{i+1} + d_i}{2}\,.
\end{equation}

Dosazením vztahu \eqref{eq:4_47} do \eqref{eq:4_46} vyjde

\begin{equation} \label{eq:4_48}
    \varepsilon = \frac{1}{12} \sum\limits_{i=0}^{I-1} p_\mathrm{f}(r_i)(d_{i+1} + d_i)^3\,.
\end{equation}

Optimální hodnoty úrovní \textit{d}$_i$ lze nalézt minimalizací hodnoty $\varepsilon$. Øešení této optimalizaèní úlohy je ponìkud nepøíjemné. V \cite{Pratt01} se jako pøibliné øešení uvádí vztah

\begin{equation} \label{eq:4_49}
    d_i = \frac{(a_\mathrm{H} - a_\mathrm{L}) \int\limits_{a_\mathrm{L}}^{a_i} \left[ p_\mathrm{f}(z)\right]^{-1/3}\,\dz}{\int\limits_{a_\mathrm{L}}^{a_\mathrm{H}} \left[ p_\mathrm{f}(z)\right]^{-1/3}\,\dz} + a_\mathrm{L}, \quad \mathrm{kde} \,\,\, a_i = \frac{i(a_\mathrm{H} - a_\mathrm{L})}{I} + a_\mathrm{L}.
\end{equation}

Ze vztahu \eqref{eq:4_49} je zøejmé, e jestlie je rozdìlení pravdìpodobnosti rovnomìrné, vychází také rozhodovací úrovnì $d_i$ rozmístìny pravidelnì.

Komplikace nastávají v pøípadì, kdy je poèet kvantovacích úrovní malı, take hustotu pravdìpodobnosti na kvantovacím intervalu nelze povaovat za konstantní. V takovém pøípadì není moné provést zjednodušení pouité ve vırazu \eqref{eq:4_46}, ale je nutné pracovat s vırazem \eqref{eq:4_45}. Za povšimnutí stojí také problém kvantování v~barevnıch obrazech. Jak víme, je barva èasto reprezentována trojicí $R, G, B$ intenzit základních barevnıch sloek. Vlivem kvantování intenzity barevnıch sloek mùe u barevnıch obrazù dojít k~nepøesnostem nejen v~intenzitì, ale i v~barevném odstínu.